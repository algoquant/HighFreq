sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 200
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 200
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
# Wilcoxon signed rank test for two normal distributions
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 500
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 500
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 500
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 500
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 500
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1000
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1000
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1000
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e3
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e4
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e4
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e4
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e4
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e4
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e4
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e4
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e4
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e4
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e5
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e5
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e5
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e5
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e5
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e6
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e6
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
sample1 <- rnorm(1e2)
sample2 <- rnorm(1e2)
sample2[1:3] <- sample2[1:3] + 1e6
wilcox.test(sample1, sample2, paired=TRUE)$p.value
t.test(sample1, sample2)$p.value
# Wilcoxon signed rank test for a mean zero uniform versus normal distribution
wilcox.test(runif(100)-0.5, rnorm(100), paired=TRUE)
# Wilcoxon signed rank test for a mean zero uniform versus normal distribution
wilcox.test(runif(100)-0.5, rnorm(100), paired=TRUE)
# Wilcoxon signed rank test for a mean zero uniform versus normal distribution
wilcox.test(runif(100)-0.5, rnorm(100), paired=TRUE)
# Wilcoxon signed rank test for a mean zero uniform versus normal distribution
wilcox.test(runif(100)-0.5, rnorm(100), paired=TRUE)
# Wilcoxon signed rank test for a mean zero uniform versus normal distribution
wilcox.test(runif(100)-0.5, rnorm(100), paired=TRUE)
# Wilcoxon signed rank test for uniform versus normal distributions
wilcox.test(runif(100)-0.5, rnorm(100), paired=TRUE)
# Wilcoxon signed rank test for uniform versus normal distributions
wilcox.test(runif(1e3)-0.5, rnorm(1e3), paired=TRUE)
da_ta <- rnorm(NROW(re_turns), sd=100)
mean(re_turns); median(re_turns)
wilcox.test(re_turns)
wilcox.test(da_ta)
da_ta <- rnorm(NROW(re_turns), sd=100)
wilcox.test(da_ta)
mean(re_turns); median(re_turns)
wilcox.test(re_turns)
median(re_turns)
# Wilcoxon signed rank test for normal distribution
da_ta <- rnorm(NROW(re_turns), sd=100)
da_ta <- (da_ta + median(re_turns))
wilcox.test(da_ta, re_turns, paired=TRUE)$p.value
t.test(da_ta, re_turns)$p.value
# Wilcoxon signed rank test for normal distribution
da_ta <- rnorm(NROW(re_turns), sd=100)
wilcox.test(da_ta, re_turns, paired=TRUE)$p.value
wilcox.test(da_ta)
wilcox.test(re_turns)
wilcox.test(da_ta, re_turns, paired=TRUE)$p.value
wilcox.test(re_turns)
wilcox.test(re_turns, paired=TRUE)
wilcox.test(re_turns, 0, paired=TRUE)
rep(0, 5)
wilcox.test(re_turns, rep(0, NROW(re_turns)), paired=TRUE)
wilcox.test(re_turns)
wilcox.test(da_ta, re_turns, paired=TRUE)$p.value
wilcox.test(da_ta)
foo <- re_turns-median(re_turns)
median(foo)
wilcox.test(re_turns-median(re_turns))
wilcox.test(re_turns)
# Same as
wilcox.test(re_turns, rep(0, NROW(re_turns)), paired=TRUE)
wilcox.test(re_turns-median(re_turns))
wilcox.test(re_turns-mean(re_turns))
# Wilcoxon signed rank test for normal distribution
da_ta <- rnorm(NROW(re_turns), sd=100)
wilcox.test(da_ta)
wilcox.test(re_turns-mean(re_turns))
# Skewed distribution with median=0
wilcox.test(re_turns-median(re_turns))
n_rows <- 1e3
da_ta <- (runif(n_rows) - 0.5)
wil_cox <- wilcox.test(da_ta)
# Calculate V statistic of Wilcoxon signed rank test
wil_cox$statistic
sum(rank(abs(da_ta))[da_ta>0])
# Calculate W statistic of Wilcoxon signed rank test
sum(sign(da_ta)*rank(abs(da_ta)))
wilcox.test(da_ta, paired=TRUE)
wilcox.test(da_ta, rep(0, n_rows), paired=TRUE)
wilcox.test(da_ta, rep(0, n_rows), paired=FALSE)
wil_cox$method
wil_cox$null.value
wil_cox$parameter
sample1 <- rnorm(200)
sample2 <- rnorm(100, mean=0.1)
# Wilcoxon rank sum test
wil_cox <- wilcox.test(sample1, sample2, paired=FALSE)
wil_cox$statistic
wilcox.test(da_ta)
wil_cox
wilcox.test(sample1, sample2, paired=TRUE)
sample1 <- rnorm(100)
sample2 <- rnorm(100, mean=0.1)
wilcox.test(sample1, sample2, paired=TRUE)
da_ta <- (sample1 - sample2)
sum(rank(abs(da_ta))[da_ta>0])
sample1 <- rnorm(100)
sample2 <- rnorm(100, mean=0.1)
# Wilcoxon signed rank test
wil_cox <- wilcox.test(sample1, sample2, paired=TRUE)
wil_cox$statistic
da_ta <- (sample1 - sample2)
sum(rank(abs(da_ta))[da_ta>0])
# Calculate W statistic of Wilcoxon signed rank test
sum(sign(da_ta)*rank(abs(da_ta)))
# Calculate distributon of Wilcoxon W statistic
wilcox_w <- sapply(1:1e3, function(x) {
da_ta <- (runif(n_rows) - 0.5)
sum(sign(da_ta)*rank(abs(da_ta)))
})  # end sapply
wilcox_w <- wilcox_w/sqrt(n_rows*(n_rows+1)*(2*n_rows+1)/6)
var(wilcox_w)
x11(width=6, height=5)  # Plot in window
par(mar=c(2, 2, 2, 1), oma=c(1, 1, 1, 1))
hist(wilcox_w, col="lightgrey",
xlab="returns", breaks=1e3, xlim=c(-3, 3),
ylab="frequency", freq=FALSE,
main="SPY Returns Histogram")
lines(density(wilcox_w, bw=0.4), lwd=3, col="red")
hist(wilcox_w, col="lightgrey",
xlab="returns", breaks=1e2, xlim=c(-3, 3),
ylab="frequency", freq=FALSE,
main="SPY Returns Histogram")
lines(density(wilcox_w, bw=0.4), lwd=3, col="red")
curve(expr=dnorm, add=TRUE, lwd=3, col="blue")
n_rows
hist(wilcox_w, col="lightgrey",
xlab="returns", breaks=50, xlim=c(-3, 3),
ylab="frequency", freq=FALSE,
main="Wilcoxon W Statistic Histogram")
lines(density(wilcox_w, bw=0.4), lwd=3, col="red")
curve(expr=dnorm, add=TRUE, lwd=3, col="blue")
# Add legend
legend("topright", inset=0.05, bty="n",
leg=c("W density", "Normal"),
lwd=6, lty=1, col=c("red", "blue"))
# Wilcoxon signed rank test for normal distribution
da_ta <- rnorm(NROW(re_turns), sd=100)
wilcox.test(da_ta, paired=FALSE)
# Skewed distribution with mean=0
mean(re_turns); median(re_turns)
wilcox.test(re_turns-mean(re_turns), paired=FALSE)
# Same as
wilcox.test(re_turns-mean(re_turns), rep(0, NROW(re_turns)), paired=FALSE)
wilcox.test(re_turns-mean(re_turns), paired=FALSE)
# Skewed distribution with median=0
wilcox.test(re_turns-median(re_turns), paired=FALSE)
ls()
sample1 <- rnorm(200)
sample2 <- rnorm(100, mean=0.1)
wil_cox <- wilcox.test(sample1, sample2, paired=FALSE)
wil_cox$statistic
da_ta <- c(sample1, sample2)
rank_s <- rank(da_ta)
sum(rank_s[1:200]) - 100*201
sum(rank_s[201:300]) - 50*101
# Wilcoxon signed rank test for normal distribution
da_ta <- rnorm(NROW(re_turns), sd=100)
# Skewed distribution with median=0
wilcox.test(re_turns-median(re_turns), da_ta, paired=FALSE)
sd(re_turns-median(re_turns))
sd(da_ta)
wilcox.test(re_turns-median(re_turns), rnorm(NROW(re_turns), sd=100), paired=FALSE)
wilcox.test(re_turns-median(re_turns), rnorm(NROW(re_turns), sd=100), paired=FALSE)
wilcox.test(re_turns-median(re_turns), rnorm(NROW(re_turns), sd=100), paired=FALSE)
wilcox.test(re_turns-median(re_turns), rnorm(NROW(re_turns), sd=100), paired=FALSE)
da_ta <- (-re_turns)
da_ta <- (da_ta-median(da_ta))
median(da_ta)
wilcox.test(re_turns-median(re_turns), da_ta, paired=FALSE)
# Data samples
sample1 <- sample(re_turns, size=NROW(re_turns))
sample1 <- sample(re_turns, size=NROW(re_turns))
sample2 <- (-sample1)
sample1 <- (sample1-median(sample1))
sample2 <- (sample2-median(sample2))
# Mann-Whitney-Wilcoxon rank sum test
wil_cox <- wilcox.test(sample1, sample2, paired=FALSE)$statistic
# Mann-Whitney-Wilcoxon rank sum test
wilcox.test(sample1, sample2, paired=FALSE)$statistic
wil_cox <- wilcox.test(sample1, sample2, paired=FALSE)
wil_cox$p.value
# Mann-Whitney-Wilcoxon rank sum test
wilcox.test(sample1, sample2, paired=FALSE)$p.value
foo <- sapply(1:100, function(x) {
# Data samples
sample1 <- sample(re_turns, size=NROW(re_turns))
sample2 <- (-sample1)
sample1 <- (sample1-median(sample1))
sample2 <- (sample2-median(sample2))
# Mann-Whitney-Wilcoxon rank sum test
wilcox.test(sample1, sample2, paired=FALSE)$p.value
})
hist(foo)
foo
tail(sample1)
median(sample1)
median(sample2)
sd(foo)
# Data samples
da_ta <- runif(22)
# Data samples
da_ta <- sort(runif(22))
da_ta
sample1 <- da_ta[c(1:5, 12:18)]
NROW(sample1)
sample1 <- da_ta[c(1:5, 12:17)]
NROW(sample1)
in_dex <- c(1:5, 12:17)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
NROW(sample2)
median(sample1)
median(sample2)
sample1
sample2
da_ta <- (-re_turns)
da_ta <- (da_ta-median(da_ta))
wilcox.test(re_turns-median(re_turns), da_ta, paired=FALSE)
wilcox.test(re_turns-median(re_turns), da_ta, paired=TRUE)
da_ta <- (-re_turns)
da_ta <- (da_ta-mean(da_ta))
wilcox.test(re_turns-median(re_turns), da_ta, paired=FALSE)
wilcox.test(re_turns-median(re_turns), da_ta, paired=TRUE)
da_ta <- (-re_turns)
da_ta <- (da_ta-mean(da_ta))
wilcox.test(re_turns-mean(re_turns), da_ta, paired=FALSE)
wilcox.test(re_turns-mean(re_turns), da_ta, paired=TRUE)
NROW(re_turns)
NROW(re_turns)/2
foo <- sapply(1:100, function(x) {
# Data samples
sample1 <- sample(re_turns, size=NROW(re_turns)/2)
sample2 <- (-sample1)
sample1 <- (sample1-median(sample1))
sample2 <- (sample2-median(sample2))
# Mann-Whitney-Wilcoxon rank sum test
wilcox.test(sample1, sample2, paired=FALSE)$p.value
})
hist(foo)
sum(foo<0.02)
sum(foo<0.05)
foo <- sapply(1:100, function(x) {
# Data samples
sample1 <- sample(re_turns, size=NROW(re_turns)/2)
sample2 <- sample(-re_turns, size=NROW(re_turns)/2)
sample1 <- (sample1-median(sample1))
sample2 <- (sample2-median(sample2))
# Mann-Whitney-Wilcoxon rank sum test
wilcox.test(sample1, sample2, paired=FALSE)$p.value
})
hist(foo)
sum(foo<0.05)
da_ta <- sort(runif(22))
in_dex <- c(1:5, 12:17)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
median(sample1)
median(sample2)
# Mann-Whitney-Wilcoxon rank sum test
wilcox.test(sample1, sample2, paired=FALSE)
wilcox.test(sample1, sample2, paired=FALSE)
wilcox.test(sample1, sample2, paired=TRUE)
da_ta <- sort(rnorm(22))
in_dex <- c(1:5, 12:17)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
median(sample1)
median(sample2)
wilcox.test(sample1, sample2, paired=FALSE)
wilcox.test(sample1, sample2, paired=TRUE)
median(da_ta)
in_dex <- c(1:9, 12:21)
da_ta <- sort(runif(38))
in_dex <- c(1:9, 12:21)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
median(sample1)
median(sample2)
NROW(sample1)
NROW(sample2)
da_ta <- sort(runif(38))
in_dex <- c(1:9, 12:21)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
median(sample1)
median(sample2)
sample1
sample2
da_ta <- sort(rnorm(22))
in_dex <- c(1:5, 12:17)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
median(sample1)
median(sample2)
da_ta <- sort(runif(22))
in_dex <- c(1:5, 12:17)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
median(sample1)
median(sample2)
da_ta <- sort(runif(22))
in_dex <- c(1:5, 12:17)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
median(sample1)
median(sample2)
da_ta <- sort(runif(22))
in_dex <- c(1:5, 12:17)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
median(sample1)
median(sample2)
NROW(sample2)
NROW(sample1)
in_dex <- c(1:9, 20:31)
da_ta <- sort(runif(38))
in_dex <- c(1:9, 20:29)
sample1 <- da_ta[in_dex]
sample2 <- da_ta[-in_dex]
median(sample1)
median(sample2)
wilcox.test(sample1, sample2, paired=FALSE)
wilcox.test(sample1, sample2, paired=TRUE)
barplot(sample1)
barplot(sample1, col="red")
barplot(sample2, col="blue")
barplot(sample1, col="red")
sample1
sample2
?barplot
barplot(sample1, col="red")
barplot(sample2, col="blue", add=TRUE)
barplot(sample1, col="blue")
barplot(sample2, col="red", add=TRUE)
barplot(sample2, col="red")
barplot(sample1, col="blue", add=TRUE)
blue <- rgb(0, 0, 1, alpha=0.5)
red <- rgb(1, 0, 0, alpha=0.5)
barplot(sample2, col=red)
barplot(sample1, col=blue, add=TRUE)
sample1 <- rnorm(100, sd=1)
sample2 <- rnorm(100, sd=2)
# Wilcoxon signed rank test
wil_cox <- wilcox.test(sample1, sample2, paired=TRUE)
wil_cox$statistic
wil_cox
sample1 <- rnorm(100, sd=1)
sample2 <- rnorm(100, sd=10)
# Wilcoxon signed rank test
wil_cox <- wilcox.test(sample1, sample2, paired=TRUE)
wil_cox
# Wilcoxon signed rank test
wilcox.test(sample1, sample2, paired=TRUE)
sample1 <- rnorm(1e3, sd=1)
sample2 <- rnorm(1e3, sd=10)
# Wilcoxon signed rank test
wilcox.test(sample1, sample2, paired=TRUE)
# Skewed distribution with median=0
wilcox.test(re_turns-median(re_turns))
wilcox.test(re_turns-mean(re_turns))
# Wilcoxon signed rank test
wilcox.test(sample1, sample2, paired=TRUE)
sample1 <- rnorm(n_rows)
sample2 <- rnorm(n_rows, mean=0.1)
# Wilcoxon test
wil_cox <- wilcox.test(sample1, sample2, paired=TRUE)
wil_cox
da_ta <- (sample1 - sample2)
sum(rank(abs(da_ta))[da_ta>0])
# Calculate W statistic of Wilcoxon test
sum(sign(da_ta)*rank(abs(da_ta)))
# Wilcoxon test for normal distribution
da_ta <- rnorm(NROW(re_turns), sd=100)
wilcox.test(da_ta, paired=FALSE)
wilcox.test(da_ta, paired=TRUE)
2800*(31-10)
2800*(31-10)/31
2800*(31-10)/30
2800/31
2800*(31-9)/31
2800*(31-12)/31
2800/30
2800*(31-12)/30
31-12
